$(function(){function t(t){return t.toString().replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function e(e,o){void 0===e&&(e={}),void 0===o&&(o={});var i,n={};for(i in e)n[i]=e[i];1==n.heading&&(n.heading="h1");var a={get data(){var t,e=this.filename.lastIndexOf(".");t=e>0?this.filename.substring(0,e):this.filename;var o={toString:function(){return t}};return["model","prob","class","acc","sen","spe","auc"].forEach(function(e){o[e]=t+"."+e}),["train","test"].forEach(function(e){o[e]={toString:function(){return t+"."+e}},o[e].model=t+".model",["prob","class","acc","sen","spe","auc"].forEach(function(i){o[e][i]=t+"."+e+"."+i})}),o},get y(){var t=this.formula.indexOf("~");return t>=0?this.formula.substring(0,t):this.formula},get rhs(){var t=this.formula.indexOf("~");return t>=0?this.formula.substring(t+1):this.formula},toJSON:function(){var t={};return this.userOptionNames.forEach(function(e){t[e]=this[e]},this),t},reset:function(){this.filename="data.csv",this.postprocess="",this.split="random",this["split.conditional.condition"]="t<0",this["split.random.seed"]="123",this["split.random.ratio"]="0.7",this.formula="y~.",this.predict="probability",this["predict.probability.threshold"]="0.5",this.forestSeed="456"},userOptionNames:["filename","postprocess","split","split.conditional.condition","split.random.seed","split.random.ratio","formula","predict","predict.probability.threshold","forestSeed"],splitAvailableValues:["none","conditional","random"],predictAvailableValues:["class","probability"]};a.reset();for(i in o)a[i]=o[i];return{html:n,code:a,i18n:s.get(n.lang),encode:t}}function o(t){var e=[r,c,p,d],o=e.map(function(e){return new e(t)});return"<table><tr>"+o.map(function(e){return"<th>"+t.i18n(e.getNameId())+"</th>"}).join("")+"</tr><tr>"+o.map(function(t){return"<td><code><pre>"+t.generateCode()+"</pre></code></td>"}).join("")+"</tr></table>"}function i(e){return""+(e.html.heading?"<"+e.html.heading+">"+e.i18n("Binary classification")+"</"+e.html.heading+">":"")+"<div class='code-options'>"+e.code.userOptionNames.map(function(o){return"<div class='code-input' data-option='"+o+"'><span class='label'>"+e.i18n("options.code."+o)+":</span> <code>"+t(e.code[o])+"</code></div>"}).join("")+"</div>"+o(e)}function n(){return"statistics-classification-binary-id-"+l++}var s={data:{}};s.get=function(t){var e="en";return t=t||e,t=t.split("-")[0],function(o){var i=s.data[t][o],n=t;return void 0===i&&(i=s.data[e][o],n=e),void 0===i&&(i=o,n=null),i=i.replace(/\[\[(.*?)\]\]/g,function(e,o){var i,s,a=o.indexOf("|");0>a?(i=o,s=o):(i=o.slice(0,a),s=o.slice(a+1));var r="";return n&&t!=n&&(r=" hreflang='"+n+"'"),"<a href='https://"+n+".wikipedia.org/wiki/"+i.replace(/ /g,"_")+"'"+r+">"+s+"</a>"}),n&&t!=n?"<span lang='"+n+"'>"+i+"</span>":i}},s.data.en={"Binary classification":"[[Binary classification]]","model.baseline":"Baseline method","model.logreg":"[[Logistic regression]]","model.cart.prob":"[[Decision tree learning|Regression tree]]","model.cart.class":"[[Decision tree learning|Classification tree]]","model.forest":"[[Random forest]]","options.code.filename":"Input filename","options.code.postprocess":"Data postprocessing code","options.code.split":"[[Test set|Training/test set]] split","options.code.split.none":"none","options.code.split.conditional":"conditional","options.code.split.random":"random","options.code.split.conditional.condition":"Training set condition","options.code.split.random.seed":"Split seed","options.code.split.random.ratio":"Split ratio","options.code.formula":"Formula","options.code.predict":"Model predicts","options.code.predict.class":"classes","options.code.predict.probability":"probabilities","options.code.predict.probability.threshold":"Classification probability threshold","options.code.forestSeed":"Random forest seed","Reset options":"Reset options","comment.data":"load data","comment.postprocess":"postprocess data","comment.split":"split data into [[Test set|training/test set]]","comment.data.model":"build model","comment.data.prob":"in-sample probability prediction","comment.data.train.prob":"training set probability prediction","comment.data.test.prob":"test set probability prediction","comment.data.class":"in-sample class prediction","comment.data.train.class":"training set class prediction","comment.data.test.class":"test set class prediction","comment.data.acc":"in-sample [[Accuracy_and_precision#In_binary_classification|accuracy]]","comment.data.train.acc":"training set [[Accuracy_and_precision#In_binary_classification|accuracy]]","comment.data.test.acc":"test set [[Accuracy_and_precision#In_binary_classification|accuracy]]","comment.data.sen":"in-sample [[Sensitivity_and_specificity#Sensitivity|sensitivity]]","comment.data.train.sen":"training set [[Sensitivity_and_specificity#Sensitivity|sensitivity]]","comment.data.test.sen":"test set [[Sensitivity_and_specificity#Sensitivity|sensitivity]]","comment.data.spe":"in-sample [[Sensitivity_and_specificity#Specificity|specificity]]","comment.data.train.spe":"training set [[Sensitivity_and_specificity#Specificity|specificity]]","comment.data.test.spe":"test set [[Sensitivity_and_specificity#Specificity|specificity]]","comment.data.auc":"in-sample [[Receiver_operating_characteristic#Area_under_the_curve|AUC]]","comment.data.train.auc":"training set [[Receiver_operating_characteristic#Area_under_the_curve|AUC]]","comment.data.test.auc":"test set [[Receiver_operating_characteristic#Area_under_the_curve|AUC]]"},s.data.ru={"Binary classification":"Бинарная классификация","model.baseline":"Базовый метод","model.logreg":"[[Логистическая регрессия]]","model.cart.prob":"[[Дерево принятия решений|Регрессионное дерево]]","model.cart.class":"[[Дерево принятия решений|Классификационное дерево]]","model.forest":"[[Random forest|Случайный лес]]","options.code.filename":"Имя входного файла","options.code.postprocess":"Код для обработки данных","options.code.split":"Деление на обучающую/тестовую выборку","options.code.split.none":"нет","options.code.split.conditional":"по условию","options.code.split.random":"случайное","options.code.split.conditional.condition":"Условие попадания в обучающую выборку","options.code.split.random.seed":"Инициализация (seed) деления на выборки","options.code.split.random.ratio":"Доля обучающей выборки при делении","options.code.formula":"Формула","options.code.predict":"Модель предсказывает","options.code.predict.class":"классы","options.code.predict.probability":"вероятности принадлежности","options.code.predict.probability.threshold":"Порог на вероятность для классификации","options.code.forestSeed":"Инициализация (seed) случайного леса","Reset options":"Сбросить настройки","comment.data":"загрузка данных","comment.postprocess":"обработка данных","comment.split":"деление данных на обучающую/тестовую выборку","comment.data.model":"построение модели","comment.data.prob":"предсказание вероятностей на выборке","comment.data.train.prob":"предсказание вероятностей на обучающей выборке","comment.data.test.prob":"предсказание вероятностей на тестовой выборке","comment.data.class":"предсказание классов на выборке","comment.data.train.class":"предсказание классов на обучающей выборке","comment.data.test.class":"предсказание классов на тестовой выборке","comment.data.acc":"точность (accuracy) на выборке","comment.data.train.acc":"точность (accuracy) на обучающей выборке","comment.data.test.acc":"точность (accuracy) на тестовой выборке","comment.data.sen":"чувствительность на выборке","comment.data.train.sen":"чувствительность на обучающей выборке","comment.data.test.sen":"чувствительность на тестовой выборке","comment.data.spe":"специфичность на выборке","comment.data.train.spe":"специфичность на обучающей выборке","comment.data.test.spe":"специфичность на тестовой выборке","comment.data.auc":"[[ROC-кривая#.D0.9F.D0.BB.D0.BE.D1.89.D0.B0.D0.B4.D1.8C_.D0.BF.D0.BE.D0.B4_.D0.BA.D1.80.D0.B8.D0.B2.D0.BE.D0.B9|AUC]] на выборке","comment.data.train.auc":"[[ROC-кривая#.D0.9F.D0.BB.D0.BE.D1.89.D0.B0.D0.B4.D1.8C_.D0.BF.D0.BE.D0.B4_.D0.BA.D1.80.D0.B8.D0.B2.D0.BE.D0.B9|AUC]] на обучающей выборке","comment.data.test.auc":"[[ROC-кривая#.D0.9F.D0.BB.D0.BE.D1.89.D0.B0.D0.B4.D1.8C_.D0.BF.D0.BE.D0.B4_.D0.BA.D1.80.D0.B8.D0.B2.D0.BE.D0.B9|AUC]] на тестовой выборке"};var a=function(t){this.options=t};a.prototype.generateCode=function(){return this.generateLines().join("\n")},a.prototype.generateLines=function(){function t(t){s=s.concat([this.comment("data.model")]),s="probability"==i.predict?s.concat(this.generateProbModelLines(t)):s.concat(this.generateClassModelLines(t))}function e(t,e){var o="data.test"==e;s="probability"==i.predict?s.concat([this.comment(e+".prob")],this.generateProbLines(t,o),[this.comment(e+".class")],this.generateClassFromProbLines(t)):s.concat([this.comment(e+".class")],this.generateClassFromModelLines(t,o)),s=s.concat([this.comment(e+".acc")],this.generateAccLines(t),[this.comment(e+".sen")],this.generateSenLines(t),[this.comment(e+".spe")],this.generateSpeLines(t)),"probability"==i.predict&&(s=s.concat([this.comment(e+".auc")],this.generateAucLines(t)))}var o=this.options.encode,i=this.options.code,n=i.data,s=[];return s=s.concat(this.listLibraries().map(function(t){return"library("+t+")"}),["",this.comment("data"),o(n)+"=read.csv('"+o(i.filename)+"')"]),i.postprocess&&(s=s.concat([this.comment("postprocess"),o(i.postprocess)])),"none"==i.split?(t.call(this,n),e.call(this,n,"data")):"conditional"==i.split?(s=s.concat([this.comment("split"),o(n.train)+"=subset("+o(n)+","+o(i["split.conditional.condition"])+")",o(n.test)+"=subset("+o(n)+",!("+o(i["split.conditional.condition"])+"))"]),t.call(this,n.train),e.call(this,n.train,"data.train"),e.call(this,n.test,"data.test")):"random"==i.split&&(s=s.concat([this.comment("split"),"set.seed("+o(i["split.random.seed"])+")","split=sample.split("+o(n)+"$"+o(i.y)+",SplitRatio="+o(i["split.random.ratio"])+")",o(n.train)+"="+o(n)+"[split,]",o(n.test)+"="+o(n)+"[!split,]"]),t.call(this,n.train),e.call(this,n.train,"data.train"),e.call(this,n.test,"data.test")),s},a.prototype.generateClassFromProbLines=function(t){var e=this.options.encode,o=this.options.code;return[e(t["class"])+"=+("+e(t.prob)+">="+e(o["predict.probability.threshold"])+")"]},a.prototype.generateAccLines=function(t){var e=this.options.encode,o=this.options.code;return[e(t.acc)+"=mean("+e(t)+"$"+e(o.y)+"=="+e(t["class"])+")"]},a.prototype.generateSenLines=function(t){var e=this.options.encode,o=this.options.code;return[e(t.sen)+"=mean("+e(t["class"])+"["+e(t)+"$"+e(o.y)+"==1]==1)"]},a.prototype.generateSpeLines=function(t){var e=this.options.encode,o=this.options.code;return[e(t.spe)+"=mean("+e(t["class"])+"["+e(t)+"$"+e(o.y)+"==0]==0)"]},a.prototype.generateAucLines=function(t){var e=this.options.encode,o=this.options.code;return[e(t.auc)+"=performance(","	prediction("+e(t.prob)+","+e(t)+"$"+e(o.y)+"),'auc'",")@y.values[[1]]"]},a.prototype.listLibraries=function(){return libs=[],"probability"==this.options.code.predict&&libs.push("ROCR"),"random"==this.options.code.split&&libs.push("caTools"),libs},a.prototype.comment=function(t){return"# "+this.options.i18n("comment."+t)};var r=function(t){a.call(this,t)};r.prototype=Object.create(a.prototype),r.prototype.constructor=r,r.prototype.getNameId=function(){return"model.baseline"},r.prototype.generateProbModelLines=function(t){var e=this.options.encode,o=this.options.code;return[e(t.model)+"=mean("+e(t)+"$"+e(o.y)+")"]},r.prototype.generateClassModelLines=function(t){var e=this.options.encode,o=this.options.code;return[e(t.model)+"=names(sort(-table("+e(t)+"$"+e(o.y)+")))[1]"]},r.prototype.generateProbLines=function(t){var e=this.options.encode;this.options.code;return[e(t.prob)+"=rep_len("+e(t.model)+",nrow("+e(t)+"))"]},r.prototype.generateClassFromModelLines=function(t){var e=this.options.encode;this.options.code;return[e(t["class"])+"=rep_len("+e(t.model)+",nrow("+e(t)+"))"]};var c=function(t){a.call(this,t)};c.prototype=Object.create(a.prototype),c.prototype.constructor=c,c.prototype.getNameId=function(){return"model.logreg"},c.prototype.generateProbModelLines=c.prototype.generateClassModelLines=function(t){var e=this.options.encode,o=this.options.code;return[e(t.model)+"=glm("+e(o.formula)+",data="+e(t)+",family=binomial)"]},c.prototype.generateProbLines=function(t,e){var o=this.options.encode;this.options.code;return[o(t.prob)+"=predict("+o(t.model)+(e?",newdata="+o(t):"")+",type='response')"]},c.prototype.generateClassFromModelLines=function(t,e){var o=this.options.encode;this.options.code;return[o(t["class"])+"=+(predict("+o(t.model)+(e?",newdata="+o(t):"")+",type='response')>0.5)"]};var p=function(t){a.call(this,t)};p.prototype=Object.create(a.prototype),p.prototype.constructor=p,p.prototype.getNameId=function(){return"class"==this.options.code.predict?"model.cart.class":"probability"==this.options.code.predict?"model.cart.prob":void 0},p.prototype.generateProbModelLines=function(t){var e=this.options.encode,o=this.options.code;return[e(t.model)+"=rpart("+e(o.formula)+",data="+e(t)+")"]},p.prototype.generateClassModelLines=function(t){var e=this.options.encode,o=this.options.code;return[e(t.model)+"=rpart("+e(o.formula)+",data="+e(t)+",method='class')"]},p.prototype.generateProbLines=function(t,e){var o=this.options.encode;this.options.code;return[o(t.prob)+"=predict("+o(t.model)+(e?",newdata="+o(t):"")+")"]},p.prototype.generateClassFromModelLines=function(t,e){var o=this.options.encode;this.options.code;return[o(t["class"])+"=predict("+o(t.model)+(e?",newdata="+o(t):"")+",type='class')"]},p.prototype.listLibraries=function(){return a.prototype.listLibraries.call(this).concat(["rpart"])};var d=function(t){a.call(this,t)};d.prototype=Object.create(a.prototype),d.prototype.constructor=d,d.prototype.getNameId=function(){return"model.forest"},d.prototype.generateProbModelLines=function(t){var e=this.options.encode,o=this.options.code;return["set.seed("+e(o.forestSeed)+")",e(t.model)+"=randomForest("+e(o.formula)+",data="+e(t)+")"]},d.prototype.generateClassModelLines=function(t){var e=this.options.encode,o=this.options.code;return["set.seed("+e(o.forestSeed)+")",e(t.model)+"=randomForest(as.factor("+e(o.y)+")~"+e(o.rhs)+",data="+e(t)+")"]},d.prototype.generateProbLines=function(t,e){var o=this.options.encode;this.options.code;return[o(t.prob)+"=predict("+o(t.model)+(e?",newdata="+o(t):"")+")"]},d.prototype.generateClassFromModelLines=function(t,e){var o=this.options.encode;this.options.code;return[o(t["class"])+"=predict("+o(t.model)+(e?",newdata="+o(t):"")+")"]},d.prototype.listLibraries=function(){return a.prototype.listLibraries.call(this).concat(["randomForest"])};var l=0;$(".statistics-classification-binary").each(function(){function t(){r.find("table").replaceWith(o(d)),d.html.storage&&(localStorage[d.html.storage]=JSON.stringify(d.code))}function s(t,e){r.find(".code-options [data-option^='"+t+".']").show().not("[data-option^='"+t+"."+e+".']").hide()}function a(e){function o(o){return $(o).on("input",function(){d.code[e]=this.value,t()})}function i(){return $("<select>").append(d.code[e+"AvailableValues"].map(function(t){return $("<option>").val(t).html(d.i18n("options.code."+e+"."+t))})).on("change",function(){d.code[e]=this.value,s(e,this.value),t()})}return"postprocess"==e?o("<textarea spellcheck='false'>"):"split"==e||"predict"==e?i():o("split.random.seed"==e?"<input type='number'>":"split.random.ratio"==e||"threshold"==e?"<input type='number' min='0' max='1' step='any'>":"<input type='text'>")}var r=$(this),c={heading:"SECTION"==this.nodeName,lang:r.closest("[lang]").attr("lang"),storage:r.attr("data-storage")},p={};c.storage&&localStorage[c.storage]&&(p=JSON.parse(localStorage[c.storage]));var d=e(c,p);r.html(i(d)),r.find(".code-options [data-option]").each(function(){var t=$(this),e=n(),o=t.find(".label"),i=o.attr("title"),s=$("<label for='"+e+"'>"+o.html()+"</label>");i&&s.attr("title",i),o.replaceWith(s);var r=t.find("code");r.replaceWith(a(t.attr("data-option")).attr("id",e).val(r.text()))}),r.find(".code-options [data-option]").each(function(){var t=$(this),e=t.find("select");e.length&&s(t.attr("data-option"),e.val())}),r.find(".code-options").append($("<div class='code-input' />").append($("<button type='button'>"+d.i18n("Reset options")+"</button>").click(function(){d.code.reset(),r.find(".code-options [data-option]").each(function(){var t=$(this),e=t.attr("data-option");t.find("input").each(function(){this.value=d.code[e]})}),t()})))})});
//# sourceMappingURL=statistics-classification-binary.js.map